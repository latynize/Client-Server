async function verifyToken(e){if(console.log(window.location.pathname),"/index.html"!==window.location.pathname)try{var t={access_token:e};await fetch("https://cioban.de/api/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>{e.ok?console.log("Token is valid"):(e.json().then((e=>{console.log(e)})),console.log(e.status),console.log("Token is invalid or expired"),window.location.href="index.html")}))}catch(e){console.error("Error verifying token:",e)}}const token=localStorage.getItem("token");async function checkLogin(){const e=document.getElementById("username").value,t=document.getElementById("password").value;var n={username:e,password:await hash(t)};try{const e=await fetch("https://cioban.de/api/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(e.ok){const t=await e.json();localStorage.setItem("token",t.token),window.location.href="01_startpage.html"}else{const t=await e.json();alert(t.detail)}}catch(e){console.error("Fehler bei der Anmeldung:",e)}}function hash(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-256",t).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")))}function clearStorage(){localStorage.clear()}function openPopup(){document.getElementById("popup-container").style.display="block",updateInputs()}function closePopup(){document.getElementById("popup-container").style.display="none",document.getElementById("error-message").style.display="none",document.getElementById("success-message").style.display="none",location.reload()}function updateInputs(){document.getElementById("error-message").style.display="none",document.getElementById("success-message").style.display="none",document.getElementById("auswahl").style.display="block";var e=document.getElementById("auswahl").value,t=document.getElementById("eingabefelder"),n=document.getElementById("buttons");t.innerHTML="",n.innerHTML="";var o=document.createElement("button");if(o.textContent="Schließen",o.className="btn text-truncate add-another-btn",o.style.color="black",o.onclick=closePopup,n.appendChild(o),"bearbeiten"===e)(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){setTimeout((function(){openEdit(r.value)}))},n.appendChild(a);else if("löschen"===e){var r;(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Löschen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=applyDelete,n.appendChild(a)}else if("erstellen"===e){var a;["Vorname","Name","Grund FTE","Mail","Tel. Nr.","Beschäftigungsstart YYYY-MM-DD","Erfahrungsgrad ID","Typ ID","Adress ID"].forEach((function(e){var n=document.createElement("input");n.type="text",n.placeholder=e,t.appendChild(n)})),(a=document.createElement("button")).textContent="Erstellen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=applyCreate,n.appendChild(a)}}function validateInputs(){for(var e=document.querySelectorAll('#eingabefelder input[type="text"]'),t=0;t<e.length;t++)if(""===e[t].value.trim())return!1;return!0}function getInputsValuesEdit(){var e=document.querySelectorAll('#eingabefelder input[type="text"], #eingabefelder select'),t={first_name:"",last_name:"",base_fte:0,free_fte:0,e_mail:"",phone_number:"",entry_date:"",experience_level_id:0,type_id:0,address_id:0};return e.forEach((function(e){var n=e.placeholder?e.placeholder.toLowerCase():"",o=e.id;if("expLevelIdDropdown"===o)t.experience_level_id=parseInt(e.value)||0;else if("typeIdDropdown"===o)t.type_id=parseInt(e.value)||0;else if("addressIdDropdown"===o)t.address_id=parseInt(e.value)||0;else{var r=e.value.trim();switch(n){case"vorname":t.first_name=r;break;case"name":t.last_name=r;break;case"grund fte":t.base_fte=parseFloat(r)||0;break;case"freie fte":t.free_fte=parseFloat(r)||0;break;case"mail":t.e_mail=r;break;case"tel. nr.":t.phone_number=r;break;case"beschäftigungsstart yyyy-mm-dd":t.entry_date=r}}})),t}function getInputsValues(){var e=document.querySelectorAll('#eingabefelder input[type="text"]'),t={first_name:"",last_name:"",base_fte:0,free_fte:0,e_mail:"",phone_number:"",entry_date:"",experience_level_id:0,type_id:0,address_id:0};return e.forEach((function(e){var n=e.placeholder.toLowerCase(),o=e.value.trim();switch(n){case"vorname":t.first_name=o;break;case"name":t.last_name=o;break;case"grund fte":t.base_fte=parseFloat(o)||0;break;case"freie fte":t.free_fte=t.base_fte;break;case"mail":t.e_mail=o;break;case"tel. nr.":t.phone_number=o;break;case"beschäftigungsstart yyyy-mm-dd":t.entry_date=o;break;case"erfahrungsgrad id":t.experience_level_id=parseInt(o)||0;break;case"typ id":t.type_id=parseInt(o)||0;break;case"adress id":t.address_id=parseInt(o)||0}})),t}function displayErrorMessage(e){var t=document.getElementById("error-message");t.textContent=e,t.style.display="block",setTimeout((function(){t.style.display="none"}),2e3)}function displaySuccessMessage(e){var t=document.getElementById("success-message");t.textContent=e,t.style.display="block",t.style.color="green",setTimeout((function(){t.style.display="none"}),2e3)}async function openEdit(e){if(validateInputs()){var t=document.getElementById("auswahl"),n=document.getElementById("eingabefelder"),o=document.getElementById("buttons");t.style.display="none",n.innerHTML="",o.innerHTML="";["Vorname","Name","Grund FTE","Freie FTE","Mail","Tel. Nr.","Beschäftigungsstart YYYY-MM-DD","Erfahrungsgrad ID","Typ ID","Adress ID"].forEach((function(e){if("Erfahrungsgrad ID"===e)(t=document.createElement("select")).type="text",t.placeholder=e,t.id="expLevelIdDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/experience_level").then((e=>e.json())).then((e=>{const t=document.getElementById("expLevelIdDropdown");e.experience_level.forEach((e=>{const n=document.createElement("option");n.value=e.experience_level.experience_level_id,n.textContent=e.experience_level.exp_lvl_description,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}));else if("Typ ID"===e){(t=document.createElement("select")).type="text",t.id="typeIdDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/type").then((e=>e.json())).then((e=>{const t=document.getElementById("typeIdDropdown");e.type.forEach((e=>{const n=document.createElement("option");n.value=e.type.type_id,n.textContent=e.type.type_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}))}else if("Adress ID"===e){(t=document.createElement("select")).type="text",t.id="addressIdDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/address").then((e=>e.json())).then((e=>{const t=document.getElementById("addressIdDropdown");e.address.forEach((e=>{const n=document.createElement("option");n.value=e.address.address_id,n.textContent=e.address.company+", "+e.address.street,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}))}else if("Freie FTE"===e){(t=document.createElement("input")).type="text",t.placeholder=e,t.disabled=!0,t.id="freeFTE",n.appendChild(t)}else{var t;(t=document.createElement("input")).type="text",t.placeholder=e,n.appendChild(t)}}));var r=document.createElement("button");r.textContent="Zurück",r.className="btn text-truncate add-another-btn",r.style.color="black",r.onclick=updateInputs,o.appendChild(r);var a=document.createElement("button");a.textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyEdit(e)},o.appendChild(a),fillEditFields(e)}else displayErrorMessage("Bitte füllen Sie alle Eingabefelder aus.")}async function fillEditFields(e){try{const t={Intern:1,Extern:2,StudZubi:3},n={"Entry Level":1,"Junior Level":2,"Mid Level":3,"Senior Level":4,Leitend:5},o=await fetch(`https://cioban.de/api/employee/${e}`,{method:"GET"});if(!o.ok)throw new Error("Fehler beim Abrufen der Mitarbeiterinformationen");console.log("Mitarbeiterinformationen erfolgreich abgerufen!");const r=(await o.json()).employee[0];console.log(r),document.querySelector('#eingabefelder input[type="text"][placeholder="Vorname"]').value=r.first_name,document.querySelector('#eingabefelder input[type="text"][placeholder="Name"]').value=r.last_name,document.querySelector('#eingabefelder input[type="text"][placeholder="Freie FTE"]').value=r.free_fte,document.querySelector('#eingabefelder input[type="text"][placeholder="Mail"]').value=r.e_mail,document.querySelector('#eingabefelder input[type="text"][placeholder="Tel. Nr."]').value=r.phone_number,document.querySelector('#eingabefelder input[type="text"][placeholder="Beschäftigungsstart YYYY-MM-DD"]').value=r.entry_date,document.querySelector("#expLevelIdDropdown").value=n[r.exp_lvl_description],document.querySelector("#typeIdDropdown").value=t[r.type_name],document.querySelector("#addressIdDropdown").value=r.address_id}catch(e){console.error("Fehler beim Abrufen der Mitarbeiterinformationen:",e)}}async function applyEdit(e){if(validateInputs()){var t=getInputsValuesEdit();console.log("Bearbeiten angewendet:",t),console.log(JSON.stringify(t));try{if(!(await fetch(`https://cioban.de/api/employee/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Bearbeiten des Projekts");console.log("Bearbeiten erfolgreich!"),displaySuccessMessage("Bearbeiten erfolgreich!")}catch(e){displayErrorMessage("Fehler beim Bearbeiten.")}}else displayErrorMessage("Bitte füllen Sie alle Eingabefelder aus.")}async function applyDelete(){if(validateInputs()){var e=document.getElementById("eingabefelder").querySelector("input[type='text']").value;console.log("Löschen angewendet:",e);try{if(!(await fetch(`https://cioban.de/api/employee/${e}`,{method:"DELETE"})).ok)throw new Error("Fehler beim Löschen des Mitarbeiters");console.log("Löschen erfolgreich!"),displaySuccessMessage("Löschen erfolgreich!")}catch(e){displayErrorMessage("Fehler beim löschen.")}}else displayErrorMessage("Bitte füllen Sie alle Eingabefelder aus.")}async function applyCreate(){if(validateInputs()){var e=getInputsValues(),t=[e];console.log("Erstellen angewendet:",e),console.log(JSON.stringify(e));try{if(!(await fetch("https://cioban.de/api/employee",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Erstellen des Mitarbeiters");console.log("Erstellung erfolgreich!"),displaySuccessMessage("Erstellung erfolgreich!")}catch(e){displayErrorMessage("Fehler beim erstellen.")}}else displayErrorMessage("Bitte füllen Sie alle Eingabefelder aus.")}function openProjectPopup(){document.getElementById("popup-container-project").style.display="block",updateProjectInputs()}function closeProjectPopup(){document.getElementById("popup-container-project").style.display="none",document.getElementById("error-message-project").style.display="none",document.getElementById("success-message-project").style.display="none",location.reload()}function updateProjectInputs(){document.getElementById("error-message-project").style.display="none",document.getElementById("success-message-project").style.display="none";var e=document.getElementById("auswahl-project").value;document.getElementById("auswahl-project").style.display="block";var t=document.getElementById("eingabefelder-project"),n=document.getElementById("buttons-project");t.innerHTML="",n.innerHTML="";var o=document.createElement("button");if(o.textContent="Schließen",o.className="btn text-truncate add-another-btn",o.style.color="black",o.onclick=closeProjectPopup,n.appendChild(o),"bearbeiten"===e)(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){openProjectEdit(r.value)},n.appendChild(a);else if("löschen"===e){var r;(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Löschen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=applyProjectDelete,n.appendChild(a)}else if("erstellen"===e){var a;["Bezeichnung","Abteilungs ID","Priorität","Projektmanager ID","Benötigte FTE","Startdatum (YYYY-MM-DD)","Enddatum (YYYY-MM-DD)"].forEach((function(e){var n=document.createElement("input");n.type="text",n.placeholder=e,t.appendChild(n)})),(a=document.createElement("button")).textContent="Erstellen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyProjectCreate()},n.appendChild(a)}}function validateProject(){for(var e=document.querySelectorAll('#eingabefelder-project input[type="text"]'),t=0;t<e.length;t++)if(""===e[t].value.trim())return!1;return!0}function getProjectInputValuesEdit(){var e=document.querySelectorAll('#eingabefelder-project input[type="text"], #eingabefelder-project select'),t={department_id:0,proj_name:"",proj_priority:"",proj_manager:0,needed_fte:0,current_fte:0,start_date:"",end_date:""};return e.forEach((function(e){var n=e.placeholder?e.placeholder.toLowerCase():"",o=e.id;if("departmentDropdown"===o)t.department_id=parseInt(e.value)||0;else if("employeeDropdown"===o)t.proj_manager=parseInt(e.value)||0;else{var r=e.value.trim();switch(n){case"bezeichnung":t.proj_name=r;break;case"priorität":t.proj_priority=r;break;case"benötigte fte":t.needed_fte=parseFloat(r)||0;break;case"aktuelle fte":t.current_fte=parseFloat(r)||0;break;case"startdatum (yyyy-mm-dd)":t.start_date=r;break;case"enddatum (yyyy-mm-dd)":t.end_date=r}}})),t}function getProjectInputValues(){var e=document.querySelectorAll('#eingabefelder-project input[type="text"]'),t={department_id:0,proj_name:"",proj_priority:"",proj_manager:0,needed_fte:0,current_fte:0,start_date:"",end_date:""};return e.forEach((function(e){var n=e.placeholder.toLowerCase(),o=e.value.trim();switch(n){case"bezeichnung":t.proj_name=o;break;case"abteilungs id":t.department_id=parseInt(o)||0;break;case"priorität":t.proj_priority=o;break;case"projektmanager id":t.proj_manager=parseInt(o)||0;break;case"benötigte fte":t.needed_fte=0;break;case"aktuelle fte":t.current_fte=parseFloat(o)||0;break;case"startdatum (yyyy-mm-dd)":t.start_date=o;break;case"enddatum (yyyy-mm-dd)":t.end_date=o;break;case"team ids":t.team_ids=o}})),t}function displayErrorMessageProject(e){var t=document.getElementById("error-message-project");t.textContent=e,t.style.display="block",setTimeout((function(){t.style.display="none"}),2e3)}function displaySuccessMessageProject(e){var t=document.getElementById("success-message-project");t.textContent=e,t.style.display="block",t.style.color="green",setTimeout((function(){t.style.display="none"}),2e3)}async function openProjectEdit(e){if(validateProject()){var t=document.getElementById("auswahl-project"),n=document.getElementById("eingabefelder-project"),o=document.getElementById("buttons-project");t.style.display="none",n.innerHTML="",o.innerHTML="";["Bezeichnung","Abteilungs ID","Priorität","Projektmanager ID","Benötigte FTE","Aktuelle FTE","Startdatum (YYYY-MM-DD)","Enddatum (YYYY-MM-DD)"].forEach((function(e){if("Abteilungs ID"===e)(t=document.createElement("select")).type="text",t.id="departmentDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/department").then((e=>e.json())).then((e=>{const t=document.getElementById("departmentDropdown");e.department.forEach((e=>{const n=document.createElement("option");n.value=e.department.department_id,n.textContent=e.department.dep_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}));else if("Projektmanager ID"===e){(t=document.createElement("select")).type="text",t.id="employeeDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/employee").then((e=>e.json())).then((e=>{const t=document.getElementById("employeeDropdown");e.employee.forEach((e=>{const n=document.createElement("option");n.value=e.employee_id,n.textContent=e.first_name+" "+e.last_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}))}else if("Aktuelle FTE"===e){(t=document.createElement("input")).type="text",t.placeholder=e,t.disabled=!0,n.appendChild(t)}else{var t;(t=document.createElement("input")).type="text",t.placeholder=e,n.appendChild(t)}}));var r=document.createElement("button");r.textContent="Zurück",r.className="btn text-truncate add-another-btn",r.style.color="black",r.onclick=updateProjectInputs,o.appendChild(r);var a=document.createElement("button");a.textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyProjectEdit(e)},o.appendChild(a),fillProjectEditFields(e)}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}async function fillProjectEditFields(e){try{const t={"IT-Support":1,Netzbetrieb:2,Softwareentwicklung:3,"IT-Backend":4,"IT-Frontend":5,"IT-Sicherheit":6,"IT-Projektmanagement":7,Datenanalyse:8},n=await fetch(`https://cioban.de/api/project/${e}`,{method:"GET"});if(!n.ok)throw new Error("Fehler beim Abrufen der Projektinformationen");const o=(await n.json()).project[0];document.querySelector('#eingabefelder-project input[type="text"][placeholder="Bezeichnung"]').value=o.project_name,document.querySelector("#departmentDropdown").value=t[o.department_name],document.querySelector('#eingabefelder-project input[type="text"][placeholder="Priorität"]').value=o.proj_priority,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Benötigte FTE"]').value=o.needed_fte,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Aktuelle FTE"]').value=o.current_fte,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Startdatum (YYYY-MM-DD)"]').value=o.start_date,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Enddatum (YYYY-MM-DD)"]').value=o.end_date}catch(e){console.error("Fehler beim Abrufen der Projektinformationen:",e)}}async function applyProjectEdit(e){if(validateProject()){var t=getProjectInputValuesEdit();console.log("Bearbeiten angewendet:",t),console.log(JSON.stringify(t));try{if(!(await fetch(`https://cioban.de/api/project/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Bearbeiten des Projekts");console.log("Bearbeiten erfolgreich!"),displaySuccessMessageProject("Bearbeiten erfolgreich!")}catch(e){displayErrorMessageProject("Fehler beim Bearbeiten.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function openTeamPopup(e){console.log("in openTeamPopup\n"+e);var t=document.getElementById("auswahl-project"),n=document.getElementById("eingabefelder-project"),o=document.getElementById("buttons-project");t.style.display="none",n.innerHTML="",o.innerHTML="";var r=document.createElement("div");r.id="info_team",r.textContent="Bitte erstellen sie mind. ein Team für das Projekt. Weitere Teams können im Anschluss erstellt werden.",r.style.color="black",r.style.marginBottom="10px",n.appendChild(r);["Projekt ID","Team Name","Team Zweck"].forEach((function(e){var t=document.createElement("input");t.type="text",t.placeholder=e,n.appendChild(t)})),document.querySelector('#eingabefelder-project input[type="text"][placeholder="Projekt ID"]').value=e;var a=document.createElement("button");a.textContent="Erstellen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyTeamCreate()},o.appendChild(a)}async function applyTeamCreate(){if(validateProject()){var e={project_id:document.getElementById("eingabefelder-project").querySelector("input[type='text']").value,team_name:document.getElementById("eingabefelder-project").querySelector("input[type='text'][placeholder='Team Name']").value,team_purpose:document.getElementById("eingabefelder-project").querySelector("input[type='text'][placeholder='Team Zweck']").value},t=[e];console.log("Erstellen angewendet:",t),console.log(JSON.stringify(t));try{if(!(await fetch("https://cioban.de/api/team",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Erstellen des Teams");console.log("Erstellen erfolgreich!"),displaySuccessMessageProject("Erstellen erfolgreich!"),adaptButtons(e.project_id)}catch(e){displayErrorMessageProject("Fehler beim Erstellen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function adaptButtons(e){console.log("in adaptButtons\n"+e);var t=document.getElementById("buttons-project");document.getElementById("info_team").textContent="Weitere Teams hinzufügen oder schließen.",t.innerHTML="";var n=document.createElement("button");n.textContent="Schließen",n.className="btn text-truncate add-another-btn",n.style.color="black",n.onclick=closeProjectPopup,t.appendChild(n);var o=document.createElement("button");o.textContent="weiteres Team erstellen",o.style.color="black",o.className="btn text-truncate add-another-btn",o.onclick=function(){openTeamPopup(e)},t.appendChild(o)}async function applyProjectDelete(){if(validateProject()){var e=document.getElementById("eingabefelder-project").querySelector("input[type='text']").value;console.log("Löschen angewendet:",e);try{if(!(await fetch(`https://cioban.de/api/project/${e}`,{method:"DELETE"})).ok)throw new Error("Fehler beim Löschen des Projekts");console.log("Löschen erfolgreich!"),displaySuccessMessageProject("Löschen erfolgreich!")}catch(e){displayErrorMessageProject("Fehler beim löschen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}async function applyProjectCreate(){if(validateProject()){var e=[getProjectInputValues()];console.log("Erstellen angewendet:",e),console.log(JSON.stringify(e));try{const t=await fetch("https://cioban.de/api/project",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Fehler beim Erstellen des Projekts");const n=await t.json();console.log(n);const o=n["Project ID"];displaySuccessMessageProject("Erstellen erfolgreich!"),setTimeout((function(){openTeamPopup(o)}),2e3)}catch(e){displayErrorMessageProject("Fehler beim Erstellen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function openProjectPopup(){document.getElementById("popup-container-project").style.display="block",updateProjectInputs()}function closeProjectPopup(){document.getElementById("popup-container-project").style.display="none",document.getElementById("error-message-project").style.display="none",document.getElementById("success-message-project").style.display="none",location.reload()}function updateProjectInputs(){document.getElementById("error-message-project").style.display="none",document.getElementById("success-message-project").style.display="none";var e=document.getElementById("auswahl-project").value;document.getElementById("auswahl-project").style.display="block";var t=document.getElementById("eingabefelder-project"),n=document.getElementById("buttons-project");t.innerHTML="",n.innerHTML="";var o=document.createElement("button");if(o.textContent="Schließen",o.className="btn text-truncate add-another-btn",o.style.color="black",o.onclick=closeProjectPopup,n.appendChild(o),"bearbeiten"===e)(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){openProjectEdit(r.value)},n.appendChild(a);else if("löschen"===e){var r;(r=document.createElement("input")).type="text",r.placeholder="ID",t.appendChild(r),(a=document.createElement("button")).textContent="Löschen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=applyProjectDelete,n.appendChild(a)}else if("erstellen"===e){var a;["Bezeichnung","Abteilungs ID","Priorität","Projektmanager ID","Benötigte FTE","Startdatum (YYYY-MM-DD)","Enddatum (YYYY-MM-DD)"].forEach((function(e){var n=document.createElement("input");n.type="text",n.placeholder=e,t.appendChild(n)})),(a=document.createElement("button")).textContent="Erstellen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyProjectCreate()},n.appendChild(a)}}function validateProject(){for(var e=document.querySelectorAll('#eingabefelder-project input[type="text"]'),t=0;t<e.length;t++)if(""===e[t].value.trim())return!1;return!0}function getProjectInputValuesEdit(){var e=document.querySelectorAll('#eingabefelder-project input[type="text"], #eingabefelder-project select'),t={department_id:0,proj_name:"",proj_priority:"",proj_manager:0,needed_fte:0,current_fte:0,start_date:"",end_date:""};return e.forEach((function(e){var n=e.placeholder?e.placeholder.toLowerCase():"",o=e.id;if("departmentDropdown"===o)t.department_id=parseInt(e.value)||0;else if("employeeDropdown"===o)t.proj_manager=parseInt(e.value)||0;else{var r=e.value.trim();switch(n){case"bezeichnung":t.proj_name=r;break;case"priorität":t.proj_priority=r;break;case"benötigte fte":t.needed_fte=parseFloat(r)||0;break;case"aktuelle fte":t.current_fte=parseFloat(r)||0;break;case"startdatum (yyyy-mm-dd)":t.start_date=r;break;case"enddatum (yyyy-mm-dd)":t.end_date=r}}})),t}function getProjectInputValues(){var e=document.querySelectorAll('#eingabefelder-project input[type="text"]'),t={department_id:0,proj_name:"",proj_priority:"",proj_manager:0,needed_fte:0,current_fte:0,start_date:"",end_date:""};return e.forEach((function(e){var n=e.placeholder.toLowerCase(),o=e.value.trim();switch(n){case"bezeichnung":t.proj_name=o;break;case"abteilungs id":t.department_id=parseInt(o)||0;break;case"priorität":t.proj_priority=o;break;case"projektmanager id":t.proj_manager=parseInt(o)||0;break;case"benötigte fte":t.needed_fte=0;break;case"aktuelle fte":t.current_fte=parseFloat(o)||0;break;case"startdatum (yyyy-mm-dd)":t.start_date=o;break;case"enddatum (yyyy-mm-dd)":t.end_date=o;break;case"team ids":t.team_ids=o}})),t}function displayErrorMessageProject(e){var t=document.getElementById("error-message-project");t.textContent=e,t.style.display="block",setTimeout((function(){t.style.display="none"}),2e3)}function displaySuccessMessageProject(e){var t=document.getElementById("success-message-project");t.textContent=e,t.style.display="block",t.style.color="green",setTimeout((function(){t.style.display="none"}),2e3)}async function openProjectEdit(e){if(validateProject()){var t=document.getElementById("auswahl-project"),n=document.getElementById("eingabefelder-project"),o=document.getElementById("buttons-project");t.style.display="none",n.innerHTML="",o.innerHTML="";["Bezeichnung","Abteilungs ID","Priorität","Projektmanager ID","Benötigte FTE","Aktuelle FTE","Startdatum (YYYY-MM-DD)","Enddatum (YYYY-MM-DD)"].forEach((function(e){if("Abteilungs ID"===e)(t=document.createElement("select")).type="text",t.id="departmentDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/department").then((e=>e.json())).then((e=>{const t=document.getElementById("departmentDropdown");e.department.forEach((e=>{const n=document.createElement("option");n.value=e.department.department_id,n.textContent=e.department.dep_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}));else if("Projektmanager ID"===e){(t=document.createElement("select")).type="text",t.id="employeeDropdown",t.style.width="100%",n.appendChild(t),fetch("https://cioban.de/api/employee").then((e=>e.json())).then((e=>{const t=document.getElementById("employeeDropdown");e.employee.forEach((e=>{const n=document.createElement("option");n.value=e.employee_id,n.textContent=e.first_name+" "+e.last_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}))}else if("Aktuelle FTE"===e){(t=document.createElement("input")).type="text",t.placeholder=e,t.disabled=!0,n.appendChild(t)}else{var t;(t=document.createElement("input")).type="text",t.placeholder=e,n.appendChild(t)}}));var r=document.createElement("button");r.textContent="Zurück",r.className="btn text-truncate add-another-btn",r.style.color="black",r.onclick=updateProjectInputs,o.appendChild(r);var a=document.createElement("button");a.textContent="Bearbeiten",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyProjectEdit(e)},o.appendChild(a),fillProjectEditFields(e)}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}async function fillProjectEditFields(e){try{const t={"IT-Support":1,Netzbetrieb:2,Softwareentwicklung:3,"IT-Backend":4,"IT-Frontend":5,"IT-Sicherheit":6,"IT-Projektmanagement":7,Datenanalyse:8},n=await fetch(`https://cioban.de/api/project/${e}`,{method:"GET"});if(!n.ok)throw new Error("Fehler beim Abrufen der Projektinformationen");const o=(await n.json()).project[0];document.querySelector('#eingabefelder-project input[type="text"][placeholder="Bezeichnung"]').value=o.project_name,document.querySelector("#departmentDropdown").value=t[o.department_name],document.querySelector('#eingabefelder-project input[type="text"][placeholder="Priorität"]').value=o.proj_priority,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Benötigte FTE"]').value=o.needed_fte,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Aktuelle FTE"]').value=o.current_fte,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Startdatum (YYYY-MM-DD)"]').value=o.start_date,document.querySelector('#eingabefelder-project input[type="text"][placeholder="Enddatum (YYYY-MM-DD)"]').value=o.end_date}catch(e){console.error("Fehler beim Abrufen der Projektinformationen:",e)}}async function applyProjectEdit(e){if(validateProject()){var t=getProjectInputValuesEdit();console.log("Bearbeiten angewendet:",t),console.log(JSON.stringify(t));try{if(!(await fetch(`https://cioban.de/api/project/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Bearbeiten des Projekts");console.log("Bearbeiten erfolgreich!"),displaySuccessMessageProject("Bearbeiten erfolgreich!")}catch(e){displayErrorMessageProject("Fehler beim Bearbeiten.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function openTeamPopup(e){console.log("in openTeamPopup\n"+e);var t=document.getElementById("auswahl-project"),n=document.getElementById("eingabefelder-project"),o=document.getElementById("buttons-project");t.style.display="none",n.innerHTML="",o.innerHTML="";var r=document.createElement("div");r.id="info_team",r.textContent="Bitte erstellen sie mind. ein Team für das Projekt. Weitere Teams können im Anschluss erstellt werden.",r.style.color="black",r.style.marginBottom="10px",n.appendChild(r);["Projekt ID","Team Name","Team Zweck"].forEach((function(e){var t=document.createElement("input");t.type="text",t.placeholder=e,n.appendChild(t)})),document.querySelector('#eingabefelder-project input[type="text"][placeholder="Projekt ID"]').value=e;var a=document.createElement("button");a.textContent="Erstellen",a.style.color="black",a.className="btn text-truncate add-another-btn",a.onclick=function(){applyTeamCreate()},o.appendChild(a)}async function applyTeamCreate(){if(validateProject()){var e={project_id:document.getElementById("eingabefelder-project").querySelector("input[type='text']").value,team_name:document.getElementById("eingabefelder-project").querySelector("input[type='text'][placeholder='Team Name']").value,team_purpose:document.getElementById("eingabefelder-project").querySelector("input[type='text'][placeholder='Team Zweck']").value},t=[e];console.log("Erstellen angewendet:",t),console.log(JSON.stringify(t));try{if(!(await fetch("https://cioban.de/api/team",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Fehler beim Erstellen des Teams");console.log("Erstellen erfolgreich!"),displaySuccessMessageProject("Erstellen erfolgreich!"),adaptButtons(e.project_id)}catch(e){displayErrorMessageProject("Fehler beim Erstellen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function adaptButtons(e){console.log("in adaptButtons\n"+e);var t=document.getElementById("buttons-project");document.getElementById("info_team").textContent="Weitere Teams hinzufügen oder schließen.",t.innerHTML="";var n=document.createElement("button");n.textContent="Schließen",n.className="btn text-truncate add-another-btn",n.style.color="black",n.onclick=closeProjectPopup,t.appendChild(n);var o=document.createElement("button");o.textContent="weiteres Team erstellen",o.style.color="black",o.className="btn text-truncate add-another-btn",o.onclick=function(){openTeamPopup(e)},t.appendChild(o)}async function applyProjectDelete(){if(validateProject()){var e=document.getElementById("eingabefelder-project").querySelector("input[type='text']").value;console.log("Löschen angewendet:",e);try{if(!(await fetch(`https://cioban.de/api/project/${e}`,{method:"DELETE"})).ok)throw new Error("Fehler beim Löschen des Projekts");console.log("Löschen erfolgreich!"),displaySuccessMessageProject("Löschen erfolgreich!")}catch(e){displayErrorMessageProject("Fehler beim löschen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}async function applyProjectCreate(){if(validateProject()){var e=[getProjectInputValues()];console.log("Erstellen angewendet:",e),console.log(JSON.stringify(e));try{const t=await fetch("https://cioban.de/api/project",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Fehler beim Erstellen des Projekts");const n=await t.json();console.log(n);const o=n["Project ID"];displaySuccessMessageProject("Erstellen erfolgreich!"),setTimeout((function(){openTeamPopup(o)}),2e3)}catch(e){displayErrorMessageProject("Fehler beim Erstellen.")}}else displayErrorMessageProject("Bitte füllen Sie alle Eingabefelder aus.")}function submitData(){const e=getDataByDropdown();if(!isAnyDropdownSelected)return void console.error("Bitte wählen Sie mindestens ein Dropdown-Menü aus.");const t=document.getElementById("resultPersonalTable").querySelector("tbody");t.innerHTML="",document.getElementById("personalResult").style.display="none",document.getElementById("feedbackMessage").innerText="",fetch("https://cioban.de/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{e&&e.employee&&0!==e.employee.length?(document.getElementById("feedbackMessage").innerText="",console.log(e),e.employee.forEach((e=>{const n=document.createElement("tr");n.innerHTML=`\n            <td>${e.employee_id}</td>\n            <td>${e.first_name}</td>\n            <td>${e.last_name}</td>\n            <td>${e.free_fte}</td>\n            <td>${e.e_mail}</td>\n            <td>${e.phone_number}</td>\n            <td>${e.entry_date}</td>\n            <td>${e.exp_lvl_description}</td>\n            <td>${e.type_name}</td>\n        `,t.appendChild(n)})),document.getElementById("personalResult").style.display="block"):document.getElementById("feedbackMessage").innerText="Leider wurden keine Suchergebnisse gefunden."})).catch((e=>console.error("Error fetching data:",e)))}function isAnyDropdownSelected(){const e=document.querySelectorAll("#dropdowns select");for(let t=0;t<e.length;t++)if(null!==e[t].value&&""!==e[t].value)return!0;return!1}function getDataByDropdown(){const e=document.getElementById("departmentDropdown").value||null,t=document.getElementById("employeeTypeDropdown").value||null,n=document.getElementById("jobDropdown").value||null,o=document.getElementById("experienceDropdown").value||null,r=document.getElementById("skillDropdown").value||null,a=parseFloat(document.getElementById("fteDropdown").value)||null;var l=[{department:e,job:n,experienceLevel:o,project:document.getElementById("projectDropdown").value||null,type:t,skill:r,fte:a}];return console.log(l),l}function clearData(){document.getElementById("departmentDropdown").selectedIndex=0,document.getElementById("employeeTypeDropdown").selectedIndex=0,document.getElementById("jobDropdown").selectedIndex=0,document.getElementById("experienceDropdown").selectedIndex=0,document.getElementById("skillDropdown").selectedIndex=0,document.getElementById("fteDropdown").selectedIndex=0,document.getElementById("projectDropdown").selectedIndex=0,document.getElementById("personalResult").style.display="none",document.getElementById("feedbackMessage").innerText="";document.getElementById("resultPersonalTable").querySelector("tbody").innerHTML=""}console.log("Token:",token),verifyToken(token),window.onload=function(){fetch("https://cioban.de/api/department").then((e=>e.json())).then((e=>{const t=document.getElementById("departmentDropdown");e.department.forEach((e=>{const n=document.createElement("option");n.value=e.department.dep_name,n.textContent=e.department.dep_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)})),fetch("https://cioban.de/api/type").then((e=>e.json())).then((e=>{const t=document.getElementById("employeeTypeDropdown");e.type.forEach((e=>{const n=document.createElement("option");n.value=e.type.type_name,n.textContent=e.type.type_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)})),fetch("https://cioban.de/api/job").then((e=>e.json())).then((e=>{const t=document.getElementById("jobDropdown");e.job.forEach((e=>{const n=document.createElement("option");n.value=e.job.job_name,n.textContent=e.job.job_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)})),fetch("https://cioban.de/api/project").then((e=>e.json())).then((e=>{const t=document.getElementById("projectDropdown");e.project.forEach((e=>{const n=document.createElement("option");n.value=e.project_name,n.textContent=e.project_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)})),fetch("https://cioban.de/api/experience_level").then((e=>e.json())).then((e=>{const t=document.getElementById("experienceDropdown");e.experience_level.forEach((e=>{const n=document.createElement("option");n.value=e.experience_level.exp_lvl_description,n.textContent=e.experience_level.exp_lvl_description,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)})),fetch("https://cioban.de/api/skill").then((e=>e.json())).then((e=>{const t=document.getElementById("skillDropdown");e.skill.forEach((e=>{const n=document.createElement("option");n.value=e.skill.skill_name,n.textContent=e.skill.skill_name,t.appendChild(n)}))})).catch((e=>{console.error("Error:",e)}))},document.addEventListener("DOMContentLoaded",(function(){for(var e=document.getElementById("personalTable"),t=document.getElementById("popupContainer"),n=document.getElementById("popupContent"),o=document.getElementById("rowData"),r=document.getElementById("closeBtn"),a=e.rows[0].cells.length,l=[],c=0;c<a;c++)l.push(e.rows[0].cells[c].innerHTML);n.style.padding="40px",n.style.borderRadius="20px",n.style.fontSize="16px",n.style.border="1px solid lightgrey",n.style.borderRadius="5px";var d=e.getElementsByTagName("tr");for(c=1;c<d.length;c++)d[c].onclick=function(){for(var e="",n=0;n<a;n++)e+=l[n]+": "+this.cells[n].innerHTML+"<br>";o.innerHTML=e,t.style.display="block"};r.onclick=function(){t.style.display="none"}})),$(document).ready((function(){$(".search-container #advanced-div").hide()})),$(".search-container .text-input").focusin((function(){$(this).siblings("span").animate({top:"-8px",left:"22px","font-size":"8px",color:"#000"},200),$(this).siblings("span").css({color:"rgb(173, 124, 46)"})})),$(".search-container .item-row-thumb").mouseenter((function(){$(this).siblings(".item-column-thumb-icon").animate({deg:-90},{duration:100,step:function(e){$(this).css({transform:"rotate("+e+"deg)"})}}).css({color:"#fff","background-color":"#F6C500"})})),$(".search-container .item-row-thumb").mouseleave((function(){$(".search-container .item-column-thumb-icon").animate({deg:0},{duration:100,step:function(e){$(this).css({transform:"rotate("+e+"deg)"})}}).css({color:"#F6C500","background-color":"#fff"})})),$(".search-container .text-input").focusout((function(){0===$(this).val().length?($(this).siblings("span").show(),$(this).siblings("span").animate({top:"4px",left:"45px","font-size":"12px"},200),$(this).siblings("span").css({color:"rgb(190, 190, 190)"})):$(this).siblings("span").hide()})),$(".search-container #advanced-btn").click((function(){$(".search-container #advanced-div").slideToggle("fast"),$(this).text((function(e,t){return"Hide"===t?"Advanced":"Hide"}))})),$(document).ready((function(){$(".alertcontainer .search-sidebar").hide()})),$(".alertcontainer .linkbell").click((function(){$(".alertcontainer .search-sidebar").slideToggle("fast")})),$(".alertcontainer .text-input").focusin((function(){$(this).siblings("span").animate({top:"-8px",left:"22px","font-size":"8px",color:"#000"},200),$(this).siblings("span").css({color:"rgb(173, 124, 46)"})})),$(".alertcontainer textarea").focusin((function(){$(this).siblings("span").animate({top:"-8px",left:"22px","font-size":"8px",color:"#000"},200),$(this).siblings("span").css({color:"rgb(173, 124, 46)"})})),$(".alertcontainer textarea").focusout((function(){0===$(this).val().length?($(this).siblings("span").show(),$(this).siblings("span").animate({top:"8px",left:"45px","font-size":"10px"},200),$(this).siblings("span").css({color:"rgb(190, 190, 190)"})):$(this).siblings("span").hide()})),$(".alertcontainer .item-row-thumb").mouseenter((function(){$(this).siblings(".item-column-thumb-icon").animate({deg:-90},{duration:100,step:function(e){$(this).css({transform:"rotate("+e+"deg)"})}}).css({color:"#fff","background-color":"#F6C500"})})),$(".alertcontainer .item-row-thumb").mouseleave((function(){$(".alertcontainer .item-column-thumb-icon").animate({deg:0},{duration:100,step:function(e){$(this).css({transform:"rotate("+e+"deg)"})}}).css({color:"#F6C500","background-color":"#fff"})})),$(".alertcontainer .text-input").focusout((function(){0===$(this).val().length?($(this).siblings("span").show(),$(this).siblings("span").animate({top:"8px",left:"45px","font-size":"10px"},200),$(this).siblings("span").css({color:"rgb(190, 190, 190)"})):$(this).siblings("span").hide()}));